{% extends 'base.html' %}
{% block content %}
  <!-- Page Heading Start-->
  <div class="breadcrumbs shadow-0">
    <div class="breadcrumbs-inner">
      <div class="row m-0">
        <div class="col-sm-4">
          <div class="page-header float-left">
            <div class="page-title">
              <h1>Profile</h1>
            </div>
          </div>
        </div>
        <div class="col-sm-8">
          <div class="page-header float-right">
            <div class="page-title">
              <ol class="breadcrumb text-right">
                <li><a href="/">Dashboard</a></li>
                <li class="active">Profile</li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Page Heading End-->
 
  <!-- Page Content Goes Here-->
  <div class="content mt-3" id="main_container" style="color: black !important">
    <div class="row">
      <!-- profile-widget -->
      <div class="col-lg-12">
        <div class="card profile-widget profile-widget-info" style="position: relative;">
          <!-- <img class="my-img rounded-circle def-institute-logo" src="{{ user_info.institute.logo }}" alt="">
          <img class="card-img-top" src="{{ user_info.institute.institute_image }}" alt="Card image cap"> -->
          <!-- <h2 class="def-institute-name">{{ user_info.institute.name }}</h2> -->
          <div class="card-body pl-0 pt-0 pb-0" style="position: relative;">
            <!-- <a style="position: absolute;right:1rem;top:0.5rem;z-index:2;" class="btn text-primary rounded-circle mt-2 pull-right" data-toggle="tooltip" data-placement="left" title="Edit profile details." href="{% url 'dashboard:profile_edit' %}"><i class="fa fa-pencil"></i></a> -->
            <a style="position: absolute;right:1rem;top:0.0rem;"  class="btn text-primary rounded-circle mt-2 pull-right" data-toggle="tooltip" data-placement="left" title="Edit profile details." id="update_profile" onclick="document.getElementById('UpdatePersonalPanel').style.visibility= 'visible'; document.getElementById('main_container').style.opacity= '1';" ><i class="fa fa-pencil"></i></a>
            <!-- href="{% url 'dashboard:profile_edit' %}" -->
            <!-- onclick="document.getElementById('UpdatePersonalPanel').style.visibility= 'hidden'; document.getElementById('main_container').style.opacity= '1';" -->
            <div class="col-lg-2 col-sm-2 p-0">
              <div class="follow-ava">
                <img class="my-img" src="/media/{{ request.user.image }}" alt="">
              </div>
            </div>

            <div class="col-lg-4 col-sm-4 follow-info">

              <!-- <h4 class="text-primary">{{ request.user.get_short_name }}</h4> -->
              <p class="mb-1"><i style="min-width:25px;text-align: center;" class="fa fa-envelope"></i><b style="width: 70px;display: inline-block;">Email</b>: </p>
              <p class="mb-1"><i style="min-width:25px;text-align: center;" class="fa fa-mobile"></i><b style="width: 70px;display: inline-block;">Mobile</b>: </p>

              <p class="mb-1">
                <i style="min-width:25px;text-align: center;" class="fa fa-shield"></i><b style="width: 70px;display: inline-block;">Role</b>:
              </p>
            <div class="col-lg-6 col-sm-12 follow-info">
              <h4 class="text-primary"></h4>
              <p class="mb-1"><i style="min-width:25px;text-align: center;" class="fa fa-envelope"></i><b style="width: 70px;display: inline-block;">Email</b>:</p>
              <p class="mb-1"><i style="min-width:25px;text-align: center;" class="fa fa-phone-square"></i><b style="width: 70px;display: inline-block;">Contact</b>: </p>
              <p class="mb-1"><i style="min-width:25px;text-align: center;" class="fa fa-address-card"></i><b style="width: 70px;display: inline-block;">Address</b>: </p>
            </div>

          </div>
        </div>
      </div>
      

    </div>    
  </div>
   <div> 
          <style type="text/css" scoped>
              input {
              /*padding: 4px 10px;*/
              /*width: 55%;*/
              width: 300px;
              color: black;
              /*margin-bottom: 10px;*/
              }

              
              </style>
                  <div class="overlay" id="UpdatePersonalPanel" style="visibility: hidden; position: absolute;width: 685px;height: auto;z-index: 1035;top: 100px;left: 390.5px; background-color: white; float: center; color: black">
                      <div class="close" onclick="document.getElementById('UpdatePersonalPanel').style.visibility= 'hidden'; document.getElementById('main_container').style.opacity= '1';">x</div>

                      <label>Email:</label>
                      <input  class="form-control" type="text" name="user_email" id="id_user_email" placeholder="Email" value="{{ user_info.user.email }}">
                      
                      <label>Mobile:</label>
                      <input  class="form-control" type="text" name="user_mobile" id="id_user_mobile" placeholder="Mobile" value="{{ user_info.user.mobile }}">
                        
                        <!-- style="border:1px solid #ddd; width: 65%;height: 42px; display: -webkit-inline-box; margin-left: 30px" -->
                      <label>Role:</label>
                       <select id="id_role" name="role" required select class="disabled_toggle form-control" >
                            <option value="" selected disabled>Role</option>
                            <option value="0" {% if user_info.role == 0 %} selected {% endif %} >Admin</option>
                            <option value="1" {% if user_info.role == 1 %} selected {% endif %} >Principal</option>
                            <option value="2" {% if user_info.role == 2 %} selected {% endif %} >Trustee</option>
                            <option value="3" {% if user_info.role == 3 %} selected {% endif %} >Director</option>
                            <option value="4" {% if user_info.role == 4 %} selected {% endif %} >HOD</option>
                            <option value="5" {% if user_info.role == 5 %} selected {% endif %} >Owner</option>
                          </select>
                          <br><br>

                      <label>Institute Name:</label>
                      <input  class="form-control" type="text" name="institute_name" id="id_inst_name" placeholder="Institute Name" value="{{ user_info.institute.name }}">
                    
                      <label>Contact:</label>
                      <input  class="form-control" type="text" name="contact" id="id_inst_contact" placeholder="Contact" value="{{ user_info.institute.contact }}">
                        
                      
                      <label>Adress:</label>
                      <input  class="form-control" type="text" name="contact" id="id_inst_address" placeholder="Address" value="{{ user_info.institute.address }}">
                      <br>
                   <div style="float: right;margin-right: 20px">
                    <span style="cursor: pointer;">
                      <a id="save" style="color: #467bff">
                      <i class="fa fa-check-square-o">save</i></a>
                    </span>
                    &nbsp;&nbsp;&nbsp;
                    <span style="cursor: pointer;">
                      <a id="cancel" style="color: #467bff" onclick="document.getElementById('UpdatePersonalPanel').style.visibility= 'hidden'; document.getElementById('main_container').style.opacity= '1';">
                      <i class="fa fa-times-circle">cancel</i></a>
                    </span>
                    </div> 
                  </div>


                  <style type="text/css">
                    .overlay {
                      background: white;
                      padding: 13px;
                      left: 150px;
                      color:white;
                      position: relative;
                      box-shadow: 1px 12px 43px -5px black;
                      opacity: 1;
                      border-radius: 9px;    
                      margin: -41% 3% 3% 3%;
                      transition: margin 2s ease;
                      animation: animate 0.8s forwards;
                      transition-duration: 2s;

                     }

                  .green{
                  background:green;
                  }

                  @keyframes animate {
                      0%   {opacity: 0.85;margin: -26% 3% 3% 3%;}
                      
                      25%  {opacity: 0.89;margin: 1% 3% 3% 3%}
                      
                      60%  {opacity: 0.89;margin: 2% 3% 3% 3%}
                      
                      100% {opacity: 0.98;margin: 3% 3% 3% 3%}
                  }
                        </style>


                <script type="text/javascript">
               $("#save").click(function(){
                      console.log(ip);
                      var url = ip+"dashboard/update_profile";
                      var formData = [];
                      // formData.push({{ user_info.user.id }});
                      formData.push($("#id_user_email").val());
                      formData.push($("#id_user_mobile").val());
                      formData.push($("#id_role").val());
                      // formData.push({{ user_info.institute.id }});
                      formData.push($("#id_inst_name").val());
                      formData.push($("#id_inst_contact").val());
                      formData.push($("#id_inst_address").val());
                      console.log(formData)
                      var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
                        $.ajax({
                        type: "post",
                        url: url,
                        csrftoken:csrftoken,
                        data:{
                          'formData' : formData,
                        },
                        success: function(response) {
                          console.log(response);
                          alert("successfully updated.");
                          location.reload();
                        },
                        error: function(response) {
                          console.log(response);
                          alert("Make sure you are entering unique data.")
                        }

                      });
                    });
                </script>
              </div>

  <script>
  $(function () {
    $('[data-toggle="tooltip"]').tooltip({
      animation:false,
    });
  });
  </script>
  <!-- Content End -->
{% endblock %}